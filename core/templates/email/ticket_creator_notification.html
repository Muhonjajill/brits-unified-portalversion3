<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ticket Assignment Notification</title>
  </head>
  <body style="font-family: Arial, sans-serif; background-color: #f4f6f9; padding: 20px; margin: 0;">

    <!-- Top Quote (outside card) -->
    <div style="background-color: #f8f9fa; border-left: 4px solid rgba(18, 54, 146, 0.3); padding: 14px 18px; border-radius: 6px; font-size: 15px; line-height: 1.6; color: #444444; max-width: 600px; margin: 0 auto 20px auto;">
        <strong style="color: #333;">Thank you for reaching out!</strong><br>
        We have received your ticket and it has been assigned to <strong>{{ ticket.assigned_to.get_full_name|default:ticket.assigned_to.username }}</strong>. You can contact them directly via their phone number: <strong>{{ ticket.assigned_to.profile.phone_number }}</strong> for further assistance.
    </div>

    <div style="background-color: #ffffff; width: 100%; max-width: 600px; margin: 0 auto; padding: 40px 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);">

        <!-- Brand Header -->
        <div style="background-color: #123692; color: white; padding: 30px; border-radius: 10px 10px 0 0; margin: -40px -30px 30px -30px; text-align: center;">
            <h1 style="font-size: 24px; font-weight: bold; margin: 0 0 5px 0;">üéüÔ∏è Ticket {{ ticket.id|stringformat:"03d" }}</h1>
            <p style="font-size: 14px; opacity: 0.9; margin: 0; color: white;">{{ ticket.title }}</p>
        </div>

        <!-- Assignment Details Box -->
        <div style="background-color: #f8f9fa; border-left: 4px solid #123692; padding: 20px; border-radius: 6px; margin: 25px 0;">
            <h3 style="color: #123692; font-size: 18px; margin: 0 0 15px 0; font-weight: 600;">Assignment Details</h3>
            <ul style="list-style: none; padding: 0; margin: 0;">
                <!-- Status -->
                <li style="font-size: 16px; color: #343a40; margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid #e9ecef;">
                    <strong style="color: #123692; font-weight: 600; display: inline-block; min-width: 160px;">Status:</strong>
                    {% with code=ticket.status|lower %}
                        <span style="display: inline-block; padding: 4px 10px; border-radius: 6px; font-size: 13px; font-weight: 700;
                            {% if code == 'open' %}background: #28a745; color: #ffffff;
                            {% elif code == 'in_progress' %}background: #ffc107; color: #212529;
                            {% elif code == 'resolved' %}background: #17a2b8; color: #ffffff;
                            {% elif code == 'closed' %}background: #6c757d; color: #ffffff;
                            {% else %}background: #6b7280; color: #ffffff;{% endif %}">
                            {{ ticket.get_status_display }}
                        </span>
                    {% endwith %}
                </li>
                <!-- Priority -->
                <li style="font-size: 16px; color: #343a40; margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid #e9ecef;">
                    <strong style="color: #123692; font-weight: 600; display: inline-block; min-width: 160px;">Priority:</strong>
                    {% with p=ticket.priority|lower %}
                        <span style="display: inline-block; padding: 4px 10px; border-radius: 6px; font-size: 13px; font-weight: 700;
                            {% if p == 'low' %}background: #17a2b8; color: #ffffff;
                            {% elif p == 'medium' %}background: #ffc107; color: #212529;
                            {% elif p == 'high' %}background: #fd7e14; color: #ffffff;
                            {% elif p == 'critical' %}background: #dc3545; color: #ffffff;
                            {% else %}background: #6b7280; color: #ffffff;{% endif %}">
                            {{ ticket.get_priority_display }}
                        </span>
                    {% endwith %}
                </li>
                <!-- Assigned To -->
                <li style="font-size: 16px; color: #343a40; margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid #e9ecef;">
                    <strong style="color: #123692; font-weight: 600; display: inline-block; min-width: 160px;">Assigned To:</strong>
                    {% if ticket.assigned_to %}
                        <span style="color:#123692; font-weight: 500;">{{ ticket.assigned_to.get_full_name|default:ticket.assigned_to.username }}</span>
                    {% else %}
                        <em style="color:#6c757d;">Not assigned</em>
                    {% endif %}
                </li>
                <!-- Engineer Phone -->
                <li style="font-size: 16px; color: #343a40; margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid #e9ecef;">
                    <strong style="color: #123692; font-weight: 600; display: inline-block; min-width: 160px;">Engineer's Phone:</strong> {{ ticket.assigned_to.profile.phone_number }}
                </li>
                <!-- Engineer ID -->
                <li style="font-size: 16px; color: #343a40; margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid #e9ecef;">
                    <strong style="color: #123692; font-weight: 600; display: inline-block; min-width: 160px;">Engineer's ID:</strong> {{ ticket.assigned_to.profile.id_number }}
                </li>
                <!-- Created By -->
                <li style="font-size: 16px; color: #343a40; margin-bottom: 12px; padding: 8px 0; border-bottom: 1px solid #e9ecef;">
                    <strong style="color: #123692; font-weight: 600; display: inline-block; min-width: 160px;">Created By:</strong> {{ ticket.created_by.get_full_name|default:ticket.created_by.username }}
                </li>
                <!-- Created At -->
                <li style="font-size: 16px; color: #343a40; margin-bottom: 0; padding: 8px 0; border-bottom: none;">
                    <strong style="color: #123692; font-weight: 600; display: inline-block; min-width: 160px;">Created At:</strong> {{ ticket.created_at|date:"Y-m-d H:i" }}
                </li>
            </ul>
        </div>

        <!-- Info Notice -->
        <div style="background-color: #e8f4fd; border-left: 4px solid #123692; color: #1a3a6b; padding: 20px; border-radius: 6px; margin: 25px 0;">
            <p style="color: #1a3a6b; margin: 0; font-size: 16px; line-height: 1.6;">
                <strong style="color: #123692;">Please Note:</strong> If you have any questions about your ticket or need further assistance, please don't hesitate to contact the assigned engineer or reach out to our support team.
            </p>
        </div>

        <!-- CTA Button -->
        <table cellpadding="0" cellspacing="0" border="0" width="100%" style="margin: 25px 0;">
            <tr>
                <td align="center">
                    <a href="{{ ticket_url }}" style="display: inline-block; background-color: #123692; color: #ffffff !important; padding: 14px 35px; border-radius: 6px; text-decoration: none; font-weight: 600; font-size: 16px; font-family: Arial, sans-serif;">View Ticket</a>
                </td>
            </tr>
        </table>

        <!-- Sign-off -->
        <p style="font-size: 16px; color: #555; line-height: 1.6; margin-bottom: 15px;">
            Best regards,<br>
            <span style="color: #123692; font-weight: 600;">The Blue River Technology Solutions Team</span>
        </p>

        <!-- Footer -->
        <div style="text-align: center; font-size: 14px; color: #6c757d; margin-top: 40px; padding-top: 20px; border-top: 1px solid #e9ecef;">
            <p style="font-size: 14px; color: #6c757d; margin: 0 0 10px 0;">&copy; 2024 Blue River Technology Solutions. All rights reserved.</p>
            <p style="font-size: 14px; color: #6c757d; margin: 5px 0 0 0;">
                <a href="mailto:support@blueriverafrica.net" style="color: #123692; text-decoration: none; font-weight: normal;">Contact Support</a>
            </p>
        </div>
    </div>
  </body>
</html>
